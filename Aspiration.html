<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aspirasi HMTI UMP</title>

    <!-- Favicon -->
    <link rel="icon" href="images/HMTI.png" />
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="Styles/Style.css">
    <link rel="stylesheet" href="Styles/Header.css">
    <link rel="stylesheet" href="Styles/Footer.css">
    <link rel="stylesheet" href="Styles/Aspiration.css">
    
    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    
    <style>
        /* INLINE STYLE UNTUK OVERRIDE JIKA PERLU */
        .mobile-menu-btn {
            display: none !important;
        }
        
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: flex !important;
            }
            
            .desktop-nav {
                display: none !important;
            }
        }
        
        /* Pastikan body punya padding untuk fixed header */
        body {
            padding-top: 80px;
            font-family: 'Inter', sans-serif;
        }
        
        @media (max-width: 768px) {
            body {
                padding-top: 70px;
            }
        }
    </style>
</head>

<body data-theme="dark">

    <!-- Placeholder untuk Header -->
    <div id="header-container"></div>

    <!-- HERO SECTION -->
    <section id="aspirasi" class="hero aspirasi-hero">
        <div class="hero-inner">
            <div class="hero-badge">
                <span class="badge-text">Aspirasi & Saran</span>
            </div>

            <h1 class="hero-title">
                <span class="title-yellow">Aspirasi HMTI UMP</span>
            </h1>

            <div class="hero-subtitle">
                <span class="subtitle-text">Sampaikan Aspirasi Anda</span>
            </div>

            <p class="hero-desc">
                Suara Anda penting bagi perkembangan HMTI UMP. Sampaikan aspirasi, kritik, dan saran untuk kemajuan bersama.
            </p>

            <a href="#form-aspirasi" class="scroll-down" aria-label="scroll">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
            </a>
        </div>
    </section>

    <!-- ASPIRASI FORM SECTION -->
    <section id="form-aspirasi" class="aspirasi-section">
        <div class="aspirasi-container">
            <!-- FORM CARD -->
            <div class="aspirasi-card">
                <div class="aspirasi-header">
                    <h2 class="aspirasi-title">Form Aspirasi HMTI UMP</h2>
                    <p class="aspirasi-subtitle">
                        Setiap aspirasi akan kami tampung dan pertimbangkan untuk perbaikan HMTI
                    </p>
                </div>

                <form id="aspirasi-form" class="aspirasi-form">
                    <div class="form-group">
                        <label for="nama" class="form-label">
                            <i class="fas fa-user"></i> Nama Lengkap
                        </label>
                        <input type="text" id="nama" class="form-input" placeholder="Masukkan nama lengkap" required>
                    </div>

                    <div class="form-group">
                        <label for="email" class="form-label">
                            <i class="fas fa-envelope"></i> Email
                        </label>
                        <input type="email" id="email" class="form-input" placeholder="contoh@email.com" required>
                    </div>

                    <div class="form-group">
                        <label for="kategori" class="form-label">
                            <i class="fas fa-tag"></i> Kategori Aspirasi
                        </label>
                        <select id="kategori" class="form-input" required>
                            <option value="" disabled selected>Pilih kategori</option>
                            <option value="akademik">Akademik & Kurikulum</option>
                            <option value="organisasi">Organisasi HMTI</option>
                            <option value="fasilitas">Fasilitas Kampus</option>
                            <option value="proker">Program Kerja</option>
                            <option value="studyclub">Study Club</option>
                            <option value="lainnya">Lainnya</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="pesan" class="form-label">
                            <i class="fas fa-comment-alt"></i> Isi Aspirasi
                        </label>
                        <textarea id="pesan" class="form-textarea" rows="6"
                            placeholder="Tuliskan aspirasi, kritik, atau saran Anda secara detail..." required></textarea>
                    </div>

                    <button type="submit" class="submit-btn">
                        <i class="fas fa-paper-plane"></i> Kirim Aspirasi
                    </button>
                </form>

                <div id="success-message" class="success-message hidden">
                    <div class="success-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3>Aspirasi Berhasil Dikirim!</h3>
                    <p>Terima kasih atas kontribusi Anda. Aspirasi Anda akan kami proses dan pertimbangkan.</p>
                    <button id="new-aspiration" class="btn-secondary">
                        <i class="fas fa-plus"></i> Kirim Aspirasi Lain
                    </button>
                </div>
            </div>

            <!-- INFO SIDE -->
            <div class="aspirasi-info">
                <div class="info-card">
                    <div class="info-icon">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <h3>Mengapa Aspirasi Penting?</h3>
                    <p>Aspirasi Anda membantu kami meningkatkan kualitas pelayanan dan program HMTI untuk seluruh anggota.</p>
                </div>

                <div class="info-card">
                    <div class="info-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <h3>Privasi Terjaga</h3>
                    <p>Data dan identitas Anda akan kami rahasiakan. Aspirasi bisa dikirim secara anonim jika diinginkan.</p>
                </div>

                <div class="info-card">
                    <div class="info-icon">
                        <i class="fas fa-history"></i>
                    </div>
                    <h3>Proses Tindak Lanjut</h3>
                    <p>Setiap aspirasi akan kami tinjau dalam rapat mingguan dan berikan respons maksimal 7 hari kerja.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Placeholder untuk Footer -->
    <div id="footer-container"></div>

    <!-- JavaScript -->
    <script>
        // Fungsi untuk load komponen
        async function loadComponent(url, containerId) {
            try {
                const response = await fetch(url);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                const html = await response.text();
                document.getElementById(containerId).innerHTML = html;
                return true;
            } catch (error) {
                console.error(`Error loading ${url}:`, error);
                // Fallback
                if (containerId === 'header-container') {
                    document.getElementById(containerId).innerHTML = `
                        <div style="background: #0E1C33; color: white; padding: 20px; text-align: center;">
                            <h3>HMTI UMP - Navigation</h3>
                            <p>Header tidak dapat dimuat. <a href="index.html" style="color: #F6B128;">Kembali ke Home</a></p>
                        </div>
                    `;
                }
                return false;
            }
        }

        // Load semua komponen
        document.addEventListener('DOMContentLoaded', async function () {
            console.log('üîÑ Loading components...');

            const [headerLoaded, footerLoaded] = await Promise.all([
                loadComponent('header.html', 'header-container'),
                loadComponent('footer.html', 'footer-container')
            ]);

            if (headerLoaded && footerLoaded) {
                console.log('‚úÖ Components loaded successfully');
                setTimeout(initializeComponents, 100);
            } else {
                console.error('‚ùå Failed to load some components');
            }
        });

        // Initialize semua komponen setelah diload
        function initializeComponents() {
            console.log('‚öôÔ∏è Initializing components...');

            // 1. MOBILE MENU FUNCTIONALITY
            setupMobileMenu();
            
            // 2. SET ACTIVE NAV LINKS
            setupActiveLinks();
            
            // 3. FOOTER FUNCTIONALITY
            setupFooter();
            
            // 4. FORM FUNCTIONALITY
            if (document.getElementById('aspirasi-form')) {
                initializeForm();
            }
            
            // 5. SMOOTH SCROLL
            setupSmoothScroll();
            
            console.log('‚úÖ All components initialized!');
        }

        // Mobile menu setup
        function setupMobileMenu() {
            const menuBtn = document.getElementById('menuBtn');
            const mobileMenu = document.getElementById('mobileMenu');

            if (menuBtn && mobileMenu) {
                console.log('üì± Mobile menu elements found');
                
                // Toggle menu on button click
                menuBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    mobileMenu.classList.toggle('active');
                    
                    // Change icon
                    const icon = menuBtn.querySelector('i');
                    if (icon) {
                        icon.className = mobileMenu.classList.contains('active') 
                            ? 'fas fa-times' 
                            : 'fas fa-bars';
                    }
                });

                // Close menu when clicking outside
                document.addEventListener('click', function (e) {
                    if (mobileMenu.classList.contains('active') &&
                        !mobileMenu.contains(e.target) &&
                        !menuBtn.contains(e.target)) {
                        mobileMenu.classList.remove('active');
                        const icon = menuBtn.querySelector('i');
                        if (icon) icon.className = 'fas fa-bars';
                    }
                });

                // Close menu on link click
                mobileMenu.querySelectorAll('.mobile-nav-link').forEach(link => {
                    link.addEventListener('click', () => {
                        mobileMenu.classList.remove('active');
                        const icon = menuBtn.querySelector('i');
                        if (icon) icon.className = 'fas fa-bars';
                    });
                });
            } else {
                console.warn('‚ö†Ô∏è Mobile menu elements not found');
            }
        }

        // Active links setup
        function setupActiveLinks() {
            const currentPage = window.location.pathname.split('/').pop();
            console.log('Current page:', currentPage);

            // Set semua link tidak aktif dulu
            document.querySelectorAll('.nav-link, .mobile-nav-link').forEach(link => {
                link.classList.remove('active');
            });

            // Set active berdasarkan halaman saat ini
            document.querySelectorAll('.nav-link, .mobile-nav-link').forEach(link => {
                const href = link.getAttribute('href');
                if (href) {
                    if (currentPage.includes('aspirasi') || currentPage.includes('aspiration')) {
                        if (href.includes('aspirasi') || href.includes('aspiration')) {
                            link.classList.add('active');
                        }
                    } else if (href.includes(currentPage)) {
                        link.classList.add('active');
                    }
                }
            });
        }

        // Footer setup
        function setupFooter() {
            // Set tahun
            const yearElement = document.getElementById('year');
            if (yearElement) {
                yearElement.textContent = new Date().getFullYear();
            }

            // Footer toggle function
            window.toggleFooter = function (id) {
                const element = document.getElementById(id);
                if (element) {
                    element.classList.toggle('hidden');
                }
            };
        }

        // Form functionality
        function initializeForm() {
            console.log('üìù Initializing form...');

            const form = document.getElementById('aspirasi-form');
            const successMsg = document.getElementById('success-message');
            const newAspirationBtn = document.getElementById('new-aspiration');

            if (!form || !successMsg || !newAspirationBtn) {
                console.warn('‚ö†Ô∏è Form elements not found');
                return;
            }

            form.addEventListener('submit', function (e) {
                e.preventDefault();

                const formData = {
                    nama: document.getElementById('nama').value,
                    email: document.getElementById('email').value,
                    kategori: document.getElementById('kategori').value,
                    pesan: document.getElementById('pesan').value,
                    timestamp: new Date().toISOString(),
                    status: 'pending'
                };

                // Save to localStorage
                let aspirations = JSON.parse(localStorage.getItem('hmtia_aspirations') || '[]');
                aspirations.push(formData);
                localStorage.setItem('hmtia_aspirations', JSON.stringify(aspirations));

                // Show success message
                successMsg.classList.remove('hidden');
                form.classList.add('hidden');

                // Reset form
                form.reset();

                console.log('üì§ Form submitted successfully');
            });

            // New aspiration button
            newAspirationBtn.addEventListener('click', function () {
                successMsg.classList.add('hidden');
                form.classList.remove('hidden');
            });

            // Email validation
            const emailInput = document.getElementById('email');
            if (emailInput) {
                emailInput.addEventListener('blur', function () {
                    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailPattern.test(this.value)) {
                        this.classList.add('error');
                    } else {
                        this.classList.remove('error');
                    }
                });
            }
        }

        // Smooth scroll setup
        function setupSmoothScroll() {
            const scrollDownBtn = document.querySelector('.scroll-down');
            if (scrollDownBtn) {
                scrollDownBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector('#form-aspirasi');
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            }
        }

        // Debug viewport
        function debugViewport() {
            const width = window.innerWidth;
            const mobileBtn = document.getElementById('menuBtn');
            const desktopNav = document.querySelector('.desktop-nav');
            
            console.log(`üì± Viewport: ${width}px`);
            console.log(`Mobile button display: ${mobileBtn ? getComputedStyle(mobileBtn).display : 'not found'}`);
            console.log(`Desktop nav display: ${desktopNav ? getComputedStyle(desktopNav).display : 'not found'}`);
        }

        // Run debug on resize
        window.addEventListener('resize', debugViewport);
        
        // Error handling
        window.addEventListener('error', function (e) {
            console.error('üö® Global error:', e.message);
        });
    </script>

</body>
</html>